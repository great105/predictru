<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Telegram Bot Message Preview ‚Äî PredictRu</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: #0e1621;
    color: #e4e6eb;
    min-height: 100vh;
    display: flex;
    flex-direction: column;
  }

  .header {
    background: #17212b;
    padding: 12px 20px;
    border-bottom: 1px solid #2b3945;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .header h1 {
    font-size: 16px;
    font-weight: 600;
    color: #e4e6eb;
  }

  .header .badge {
    font-size: 11px;
    background: #2b5278;
    color: #6ab2f2;
    padding: 2px 8px;
    border-radius: 10px;
  }

  .container {
    display: flex;
    flex: 1;
    overflow: hidden;
  }

  /* Left panel ‚Äî editor */
  .editor-panel {
    width: 50%;
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    border-right: 1px solid #2b3945;
    overflow-y: auto;
  }

  .editor-panel label {
    font-size: 13px;
    color: #8b9bab;
    font-weight: 500;
  }

  .presets {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
  }

  .preset-btn {
    font-size: 12px;
    padding: 5px 10px;
    border: 1px solid #2b3945;
    border-radius: 8px;
    background: #17212b;
    color: #6ab2f2;
    cursor: pointer;
    transition: all 0.15s;
  }

  .preset-btn:hover { background: #1e2c3a; }
  .preset-btn.active { background: #2b5278; border-color: #6ab2f2; }

  textarea {
    flex: 1;
    min-height: 200px;
    background: #0e1621;
    color: #e4e6eb;
    border: 1px solid #2b3945;
    border-radius: 8px;
    padding: 12px;
    font-family: 'JetBrains Mono', 'Fira Code', monospace;
    font-size: 13px;
    line-height: 1.5;
    resize: none;
    outline: none;
  }

  textarea:focus { border-color: #6ab2f2; }

  /* Right panel ‚Äî preview */
  .preview-panel {
    width: 50%;
    padding: 16px;
    display: flex;
    flex-direction: column;
    gap: 12px;
    overflow-y: auto;
    background: #0e1621;
  }

  .chat-bg {
    flex: 1;
    background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="40" height="40"><rect fill="%230e1621" width="40" height="40"/><circle fill="%23172130" cx="20" cy="20" r="1"/></svg>');
    border-radius: 12px;
    padding: 20px;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    gap: 8px;
  }

  .message-bubble {
    max-width: 85%;
    background: #182533;
    border-radius: 12px 12px 12px 4px;
    padding: 10px 14px;
    font-size: 14px;
    line-height: 1.55;
    color: #e4e6eb;
    word-wrap: break-word;
    white-space: pre-wrap;
  }

  .message-bubble b, .message-bubble strong { color: #fff; font-weight: 600; }
  .message-bubble i, .message-bubble em { color: #8b9bab; }
  .message-bubble code {
    font-family: 'JetBrains Mono', monospace;
    font-size: 12px;
    background: #0e1621;
    padding: 1px 5px;
    border-radius: 4px;
    color: #6ab2f2;
  }
  .message-bubble pre {
    background: #0e1621;
    padding: 8px 10px;
    border-radius: 6px;
    margin: 4px 0;
    overflow-x: auto;
    font-family: 'JetBrains Mono', monospace;
    font-size: 12px;
    color: #6ab2f2;
  }
  .message-bubble a { color: #6ab2f2; text-decoration: none; }

  .keyboard-row {
    display: flex;
    gap: 4px;
    max-width: 85%;
  }

  .kb-button {
    flex: 1;
    background: #2b5278;
    border: none;
    border-radius: 8px;
    padding: 8px 12px;
    color: #e4e6eb;
    font-size: 13px;
    text-align: center;
    cursor: default;
  }

  .meta {
    font-size: 11px;
    color: #5c6f80;
    padding: 4px 0;
  }

  .char-count {
    font-size: 11px;
    color: #5c6f80;
    text-align: right;
  }

  .char-count.warn { color: #e0a030; }
  .char-count.error { color: #e05050; }
</style>
</head>
<body>

<div class="header">
  <h1>PredictRu Bot Preview</h1>
  <span class="badge">Telegram HTML</span>
</div>

<div class="container">
  <div class="editor-panel">
    <label>–®–∞–±–ª–æ–Ω—ã</label>
    <div class="presets" id="presets"></div>

    <label>HTML-—Ä–∞–∑–º–µ—Ç–∫–∞</label>
    <textarea id="editor" spellcheck="false"></textarea>

    <label>Inline-–∫–ª–∞–≤–∏–∞—Ç—É—Ä–∞ (JSON, –Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)</label>
    <textarea id="kb-editor" style="min-height:60px;max-height:100px" spellcheck="false">[]</textarea>

    <div class="char-count" id="char-count">0 —Å–∏–º–≤–æ–ª–æ–≤</div>
  </div>

  <div class="preview-panel">
    <label>–ü—Ä–µ–≤—å—é</label>
    <div class="chat-bg">
      <div class="message-bubble" id="preview"></div>
      <div id="kb-preview"></div>
      <div class="meta" id="meta">PredictRu Bot</div>
    </div>
  </div>
</div>

<script>
const PRESETS = {
  "welcome": {
    label: "üëã /start",
    html: `–ü—Ä–∏–≤–µ—Ç, <b>–ò–≤–∞–Ω</b>! üëã\n\nüìä <b>–ü—Ä–µ–¥—Å–∫–∞–∂–∏–†—É</b> ‚Äî —Ä—ã–Ω–æ–∫ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –Ω–æ–≤–æ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è\n\n–ó–¥–µ—Å—å —Ç—ã –º–æ–∂–µ—à—å:\n  ‚Ä¢ –¢–æ—Ä–≥–æ–≤–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑–∞–º–∏ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è\n  ‚Ä¢ –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å PRC-—Ç–æ–∫–µ–Ω—ã –Ω–∞ —Ç–æ—á–Ω—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è—Ö\n  ‚Ä¢ –°–æ—Ä–µ–≤–Ω–æ–≤–∞—Ç—å—Å—è —Å –¥—Ä—É–≥–∏–º–∏ —Ç—Ä–µ–π–¥–µ—Ä–∞–º–∏\n\nüéØ <b>–ü–æ–ª–∏—Ç–∏–∫–∞ ‚Ä¢ –°–ø–æ—Ä—Ç ‚Ä¢ –ö—Ä–∏–ø—Ç–æ ‚Ä¢ –≠–∫–æ–Ω–æ–º–∏–∫–∞</b>\n\nüëá –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å:`,
    kb: [["üöÄ –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"],["üåê –í–µ–±-–≤–µ—Ä—Å–∏—è"],["üí∞ –ú–æ–π –±–∞–ª–∞–Ω—Å"]]
  },
  "login_success": {
    label: "‚úÖ –õ–æ–≥–∏–Ω",
    html: `‚úÖ <b>–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!</b>\n\n–í–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ –≤–∫–ª–∞–¥–∫—É –±—Ä–∞—É–∑–µ—Ä–∞ ‚Äî –≤—Ö–æ–¥ –ø—Ä–æ–∏–∑–æ–π–¥—ë—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.`,
    kb: []
  },
  "login_used": {
    label: "‚ö†Ô∏è –¢–æ–∫–µ–Ω",
    html: `‚ö†Ô∏è –≠—Ç–æ—Ç —Ç–æ–∫–µ–Ω —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω.`,
    kb: []
  },
  "login_expired": {
    label: "‚ùå –¢–æ–∫–µ–Ω",
    html: `‚ùå –¢–æ–∫–µ–Ω –∏—Å—Ç—ë–∫. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Å–∞–π—Ç–∞ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.`,
    kb: []
  },
  "profile": {
    label: "üí∞ –ü—Ä–æ—Ñ–∏–ª—å",
    html: `üí∞ <b>–¢–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å</b>\n\nüí≥ –ë–∞–ª–∞–Ω—Å: <b>1,250.00 PRC</b>\nüìà –°–¥–µ–ª–æ–∫: <b>42</b>\nüî• –í–∏–Ω—Ä–µ–π—Ç: <b>68%</b>\n\nüí° <i>–¢–æ—Ä–≥—É–π —Ç–æ—á–Ω–µ–µ ‚Äî –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π –±–æ–ª—å—à–µ!</i>`,
    kb: [["üíº –ú–æ–π –ø–æ—Ä—Ç—Ñ–µ–ª—å"],["üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é"]]
  },
  "not_found": {
    label: "üò∂ –ù–µ –Ω–∞–π–¥–µ–Ω",
    html: `üò∂ –ê–∫–∫–∞—É–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω.\n\n–û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —á—Ç–æ–±—ã –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è üëá`,
    kb: [["üíº –ú–æ–π –ø–æ—Ä—Ç—Ñ–µ–ª—å"],["üè† –ù–∞ –≥–ª–∞–≤–Ω—É—é"]]
  },
  "resolution_win": {
    label: "üéâ –ü–æ–±–µ–¥–∞",
    html: `üéâ <b>–¢–≤–æ–π –ø—Ä–æ–≥–Ω–æ–∑ —Å–±—ã–ª—Å—è!</b>\n\nüìå –ë–∏—Ç–∫–æ–∏–Ω –≤—ã—à–µ $100K –∫ –∫–æ–Ω—Ü—É 2025?\nüéØ –ò—Å—Ö–æ–¥: <b>–î–ê</b>\nüí∞ –í—ã–ø–ª–∞—Ç–∞: <b>+150.00 PRC</b>\n\nüî• –¢–∞–∫ –¥–µ—Ä–∂–∞—Ç—å!`,
    kb: [["üìà –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä—ã–Ω–æ–∫"],["‚ùå –ó–∞–∫—Ä—ã—Ç—å"]]
  },
  "resolution_lose": {
    label: "üì¢ –ü—Ä–æ–∏–≥—Ä—ã—à",
    html: `üì¢ <b>–†—ã–Ω–æ–∫ –∑–∞–∫—Ä—ã—Ç</b>\n\nüìå –ë–∏—Ç–∫–æ–∏–Ω –≤—ã—à–µ $100K –∫ –∫–æ–Ω—Ü—É 2025?\nüéØ –ò—Å—Ö–æ–¥: <b>–î–ê</b>\n\nüí™ –í —Å–ª–µ–¥—É—é—â–∏–π —Ä–∞–∑ –ø–æ–≤–µ–∑—ë—Ç!`,
    kb: [["üìà –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Ä—ã–Ω–æ–∫"],["‚ùå –ó–∞–∫—Ä—ã—Ç—å"]]
  },
  "daily_digest": {
    label: "üåû –î–∞–π–¥–∂–µ—Å—Ç",
    html: `üåû <b>–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ!</b>\n\nüî• <b>–ì–æ—Ä—è—á–∏–µ —Ä—ã–Ω–∫–∏ —Å–µ–≥–æ–¥–Ω—è:</b>\n\n  <b>1.</b> –ö—É—Ä—Å —Ä—É–±–ª—è –Ω–∏–∂–µ 100 –∫ –∏—é–ª—é?\n     üìä –î–∞: <b>35%</b> ‚Ä¢ –û–±—ä—ë–º: <b>12,500 PRC</b>\n\n  <b>2.</b> SpaceX –∑–∞–ø—É—Å–∫ Starship –≤ –º–∞—Ä—Ç–µ?\n     üìä –î–∞: <b>72%</b> ‚Ä¢ –û–±—ä—ë–º: <b>8,300 PRC</b>\n\n  <b>3.</b> –¶–ë —Å–Ω–∏–∑–∏—Ç —Å—Ç–∞–≤–∫—É –≤ –∞–ø—Ä–µ–ª–µ?\n     üìä –î–∞: <b>18%</b> ‚Ä¢ –û–±—ä—ë–º: <b>6,100 PRC</b>\n\nüëá –û—Ç–∫—Ä–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ —Ç–æ—Ä–≥—É–π!`,
    kb: [["üöÄ –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"]]
  },
  "trade_confirm": {
    label: "‚úÖ –°–¥–µ–ª–∫–∞",
    html: `‚úÖ <b>–°–¥–µ–ª–∫–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞!</b>\n\nüìå –ë–∏—Ç–∫–æ–∏–Ω –≤—ã—à–µ $100K –∫ –∫–æ–Ω—Ü—É 2025?\nüéØ –°—Ç–æ—Ä–æ–Ω–∞: <b>–î–ê</b>\nüìä –ê–∫—Ü–∏–π: <b>10.00</b>\nüí≥ –°—Ç–æ–∏–º–æ—Å—Ç—å: <b>7.20 PRC</b>`,
    kb: []
  },
  "unavailable": {
    label: "‚ö†Ô∏è –û—à–∏–±–∫–∞",
    html: `‚ö†Ô∏è –°–µ—Ä–≤–∏—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ü–æ–ø—Ä–æ–±—É–π –ø–æ–∑–∂–µ.`,
    kb: []
  }
};

const editor = document.getElementById('editor');
const kbEditor = document.getElementById('kb-editor');
const preview = document.getElementById('preview');
const kbPreview = document.getElementById('kb-preview');
const charCount = document.getElementById('char-count');
const presetsDiv = document.getElementById('presets');

// Render presets
let activePreset = null;
Object.entries(PRESETS).forEach(([key, p]) => {
  const btn = document.createElement('button');
  btn.className = 'preset-btn';
  btn.textContent = p.label;
  btn.onclick = () => {
    document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
    activePreset = key;
    editor.value = p.html;
    kbEditor.value = JSON.stringify(p.kb, null, 2);
    render();
  };
  presetsDiv.appendChild(btn);
});

function renderTelegramHtml(raw) {
  // Allowed Telegram tags: b, strong, i, em, u, ins, s, strike, del, code, pre, a
  // First escape everything, then re-allow known tags
  let text = raw;

  // Convert newlines to <br>
  text = text.replace(/\n/g, '<br>');

  return text;
}

function render() {
  const raw = editor.value;
  preview.innerHTML = renderTelegramHtml(raw);

  // Character count
  const plain = raw.replace(/<[^>]+>/g, '').length;
  charCount.textContent = `${plain} —Å–∏–º–≤–æ–ª–æ–≤`;
  charCount.className = 'char-count' + (plain > 4096 ? ' error' : plain > 3500 ? ' warn' : '');

  // Keyboard
  try {
    const kb = JSON.parse(kbEditor.value);
    kbPreview.innerHTML = '';
    if (Array.isArray(kb)) {
      kb.forEach(row => {
        const rowDiv = document.createElement('div');
        rowDiv.className = 'keyboard-row';
        const buttons = Array.isArray(row) ? row : [row];
        buttons.forEach(label => {
          const btn = document.createElement('div');
          btn.className = 'kb-button';
          btn.textContent = typeof label === 'string' ? label : label.text || '';
          rowDiv.appendChild(btn);
        });
        kbPreview.appendChild(rowDiv);
      });
    }
  } catch {
    // ignore invalid JSON
  }
}

editor.addEventListener('input', render);
kbEditor.addEventListener('input', render);

// Load first preset
const firstKey = Object.keys(PRESETS)[0];
document.querySelector('.preset-btn').click();
</script>

</body>
</html>
